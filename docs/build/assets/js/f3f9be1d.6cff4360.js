"use strict";(globalThis.webpackChunkmcpkit_docs=globalThis.webpackChunkmcpkit_docs||[]).push([[573],{6021(e,n,r){r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>g,frontMatter:()=>s,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"guides/debugging","title":"Debugging & Monitoring","description":"MCPKit provides two decorators for observability: @Debug for development-time logging and @Monitor for production monitoring. Understanding when and how to use each is essential for building maintainable MCP servers.","source":"@site/docs/guides/debugging.md","sourceDirName":"guides","slug":"/guides/debugging","permalink":"/mcpkit/docs/guides/debugging","draft":false,"unlisted":false,"editUrl":"https://github.com/v-checha/mcpkit/tree/main/docs/docs/guides/debugging.md","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7},"sidebar":"tutorialSidebar","previous":{"title":"Testing","permalink":"/mcpkit/docs/guides/testing"},"next":{"title":"Distributed Tracing with @Traced","permalink":"/mcpkit/docs/guides/tracing-decorator"}}');var i=r(4848),t=r(8453);const s={sidebar_position:7},l="Debugging & Monitoring",a={},d=[{value:"Quick Comparison",id:"quick-comparison",level:2},{value:"@Debug Decorator",id:"debug-decorator",level:2},{value:"Basic Usage",id:"basic-usage",level:3},{value:"Debug Options",id:"debug-options",level:3},{value:"Global Debug Configuration",id:"global-debug-configuration",level:3},{value:"Environment-Based Activation",id:"environment-based-activation",level:3},{value:"Sanitizing Sensitive Data",id:"sanitizing-sensitive-data",level:3},{value:"Custom Debug Logger",id:"custom-debug-logger",level:3},{value:"Log Levels",id:"log-levels",level:3},{value:"@Monitor Decorator",id:"monitor-decorator",level:2},{value:"Basic Usage",id:"basic-usage-1",level:3},{value:"Monitor Options",id:"monitor-options",level:3},{value:"Integration with Hooks",id:"integration-with-hooks",level:3},{value:"Production Logging Example",id:"production-logging-example",level:3},{value:"Important: stdio Transport Compatibility",id:"important-stdio-transport-compatibility",level:2},{value:"Combining @Debug and @Monitor",id:"combining-debug-and-monitor",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"See Also",id:"see-also",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"debugging--monitoring",children:"Debugging & Monitoring"})}),"\n",(0,i.jsxs)(n.p,{children:["MCPKit provides two decorators for observability: ",(0,i.jsx)(n.code,{children:"@Debug"})," for development-time logging and ",(0,i.jsx)(n.code,{children:"@Monitor"})," for production monitoring. Understanding when and how to use each is essential for building maintainable MCP servers."]}),"\n",(0,i.jsx)(n.h2,{id:"quick-comparison",children:"Quick Comparison"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Feature"}),(0,i.jsx)(n.th,{children:"@Debug"}),(0,i.jsx)(n.th,{children:"@Monitor"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Purpose"})}),(0,i.jsx)(n.td,{children:"Development debugging"}),(0,i.jsx)(n.td,{children:"Production monitoring"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Default state"})}),(0,i.jsx)(n.td,{children:"Disabled (unless NODE_ENV=development)"}),(0,i.jsx)(n.td,{children:"Always active when applied"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Output"})}),(0,i.jsx)(n.td,{children:"Detailed logs with timing"}),(0,i.jsx)(n.td,{children:"Integrates with hooks system"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Sanitization"})}),(0,i.jsx)(n.td,{children:"Built-in sensitive data filtering"}),(0,i.jsx)(n.td,{children:"Manual via logger"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Performance"})}),(0,i.jsx)(n.td,{children:"Higher overhead"}),(0,i.jsx)(n.td,{children:"Lower overhead"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"debug-decorator",children:"@Debug Decorator"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"@Debug"})," decorator adds comprehensive logging for method calls, including arguments, results, timing, and errors."]}),"\n",(0,i.jsx)(n.h3,{id:"basic-usage",children:"Basic Usage"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import { MCPServer, Tool, Param, Debug } from '@mcpkit-dev/core';\n\n@MCPServer({ name: 'my-server', version: '1.0.0' })\nclass MyServer {\n  @Tool({ description: 'Process user data' })\n  @Debug({ enabled: true })\n  async processData(\n    @Param({ name: 'userId' }) userId: string,\n    @Param({ name: 'action' }) action: string\n  ) {\n    // Your logic here\n    return { success: true };\n  }\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Output"})," (to stderr):"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'[2024-01-15T10:30:00.000Z] [DEBUG] \u2192 tool:processData {\n  "type": "tool",\n  "name": "processData",\n  "args": ["user-123", "update"]\n}\n[2024-01-15T10:30:00.050Z] [DEBUG] \u2190 tool:processData \u2713 {\n  "type": "tool",\n  "name": "processData",\n  "duration": "50ms",\n  "result": { "success": true }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"debug-options",children:"Debug Options"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface DebugOptions {\n  // Enable/disable debug logging (default: based on NODE_ENV)\n  enabled?: boolean;\n\n  // Minimum log level (default: 'debug')\n  level?: 'trace' | 'debug' | 'info' | 'warn' | 'error';\n\n  // Log input arguments (default: true)\n  logArgs?: boolean;\n\n  // Log return value (default: true)\n  logResult?: boolean;\n\n  // Log execution duration (default: true)\n  logDuration?: boolean;\n\n  // Custom logger implementation\n  logger?: DebugLogger;\n\n  // Sanitize sensitive data\n  sanitize?: (key: string, value: unknown) => unknown;\n\n  // Custom label for log output\n  label?: string;\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"global-debug-configuration",children:"Global Debug Configuration"}),"\n",(0,i.jsxs)(n.p,{children:["Configure debug settings globally for all ",(0,i.jsx)(n.code,{children:"@Debug"})," decorators:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import { configureDebug, getDebugConfig } from '@mcpkit-dev/core';\n\n// Enable debug globally\nconfigureDebug({\n  enabled: true,\n  level: 'debug',\n  logArgs: true,\n  logResult: true,\n  logDuration: true,\n});\n\n// Check current config\nconst config = getDebugConfig();\nconsole.error('Debug enabled:', config.enabled);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"environment-based-activation",children:"Environment-Based Activation"}),"\n",(0,i.jsxs)(n.p,{children:["By default, ",(0,i.jsx)(n.code,{children:"@Debug"})," is automatically enabled when:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"NODE_ENV === 'development'"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"MCPKIT_DEBUG === 'true'"})}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Enable debug mode via environment\nNODE_ENV=development node dist/index.js\n\n# Or explicitly\nMCPKIT_DEBUG=true node dist/index.js\n"})}),"\n",(0,i.jsx)(n.h3,{id:"sanitizing-sensitive-data",children:"Sanitizing Sensitive Data"}),"\n",(0,i.jsx)(n.p,{children:"Prevent sensitive data from appearing in logs:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"@Tool({ description: 'User login' })\n@Debug({\n  enabled: true,\n  sanitize: (key, value) => {\n    // Redact passwords and tokens\n    if (key.toLowerCase().includes('password')) return '[REDACTED]';\n    if (key.toLowerCase().includes('token')) return '[REDACTED]';\n    if (key.toLowerCase().includes('secret')) return '[REDACTED]';\n    return value;\n  },\n})\nasync login(\n  @Param({ name: 'username' }) username: string,\n  @Param({ name: 'password' }) password: string\n) {\n  // password will appear as [REDACTED] in logs\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Built-in Sanitization"}),": By default, fields containing ",(0,i.jsx)(n.code,{children:"password"}),", ",(0,i.jsx)(n.code,{children:"token"}),", ",(0,i.jsx)(n.code,{children:"secret"}),", ",(0,i.jsx)(n.code,{children:"apiKey"}),", or ",(0,i.jsx)(n.code,{children:"authorization"})," are automatically redacted."]}),"\n",(0,i.jsx)(n.h3,{id:"custom-debug-logger",children:"Custom Debug Logger"}),"\n",(0,i.jsx)(n.p,{children:"Implement your own logger for integration with logging systems:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import { Debug, DebugLogger, DebugLevel } from '@mcpkit-dev/core';\n\nconst customLogger: DebugLogger = {\n  log(level: DebugLevel, message: string, data?: Record<string, unknown>) {\n    // Send to your logging service (always use stderr for stdio transport!)\n    console.error(JSON.stringify({\n      timestamp: new Date().toISOString(),\n      level,\n      message,\n      ...data,\n    }));\n  },\n};\n\n@Tool({ description: 'Process order' })\n@Debug({ enabled: true, logger: customLogger })\nasync processOrder(@Param({ name: 'orderId' }) orderId: string) {\n  // ...\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"log-levels",children:"Log Levels"}),"\n",(0,i.jsxs)(n.p,{children:["Control what gets logged with the ",(0,i.jsx)(n.code,{children:"level"})," option:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// Only log warnings and errors\n@Debug({ enabled: true, level: 'warn' })\n\n// Log everything including trace\n@Debug({ enabled: true, level: 'trace' })\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Level hierarchy: ",(0,i.jsx)(n.code,{children:"trace"})," < ",(0,i.jsx)(n.code,{children:"debug"})," < ",(0,i.jsx)(n.code,{children:"info"})," < ",(0,i.jsx)(n.code,{children:"warn"})," < ",(0,i.jsx)(n.code,{children:"error"})]}),"\n",(0,i.jsx)(n.h2,{id:"monitor-decorator",children:"@Monitor Decorator"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"@Monitor"})," decorator integrates with MCPKit's hooks system for production-grade monitoring."]}),"\n",(0,i.jsx)(n.h3,{id:"basic-usage-1",children:"Basic Usage"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import { MCPServer, Tool, Param, Monitor } from '@mcpkit-dev/core';\n\n@MCPServer({ name: 'my-server', version: '1.0.0' })\nclass MyServer {\n  @Tool({ description: 'Fetch data' })\n  @Monitor({ logDuration: true, logErrors: true })\n  async fetchData(@Param({ name: 'id' }) id: string) {\n    return { data: 'result' };\n  }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"monitor-options",children:"Monitor Options"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface MonitorOptions {\n  // Log input arguments (default: false)\n  logArgs?: boolean;\n\n  // Log return value (default: false)\n  logResult?: boolean;\n\n  // Log execution duration (default: true)\n  logDuration?: boolean;\n\n  // Log errors (default: true)\n  logErrors?: boolean;\n\n  // Custom logger function (default: console.error)\n  logger?: (message: string, data: Record<string, unknown>) => void;\n\n  // Separate error logger (default: console.error)\n  errorLogger?: (message: string, data: Record<string, unknown>) => void;\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"integration-with-hooks",children:"Integration with Hooks"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"@Monitor"})," works alongside server hooks. The hooks fire first, then monitor logging:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"@MCPServer({\n  name: 'my-server',\n  version: '1.0.0',\n  hooks: {\n    onToolCall: ({ toolName }) => {\n      console.error(`[HOOK] Tool called: ${toolName}`);\n    },\n    onToolSuccess: ({ toolName, duration }) => {\n      console.error(`[HOOK] Tool succeeded: ${toolName} (${duration}ms)`);\n    },\n  },\n})\nclass MyServer {\n  @Tool({ description: 'Test tool' })\n  @Monitor({ logDuration: true })\n  async testTool() {\n    return 'result';\n  }\n}\n\n// Output order:\n// [HOOK] Tool called: testTool\n// [Monitor] testTool completed { duration: \"5ms\" }\n// [HOOK] Tool succeeded: testTool (5ms)\n"})}),"\n",(0,i.jsx)(n.h3,{id:"production-logging-example",children:"Production Logging Example"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import { Monitor } from '@mcpkit-dev/core';\nimport pino from 'pino';\n\n// Create pino logger that writes to stderr\nconst logger = pino({\n  level: 'info',\n}, pino.destination(2)); // fd 2 = stderr\n\nconst prodLogger = (message: string, data: Record<string, unknown>) => {\n  logger.info(data, message);\n};\n\nconst errorLogger = (message: string, data: Record<string, unknown>) => {\n  logger.error(data, message);\n};\n\n@Tool({ description: 'Critical operation' })\n@Monitor({\n  logDuration: true,\n  logErrors: true,\n  logger: prodLogger,\n  errorLogger: errorLogger,\n})\nasync criticalOperation() {\n  // ...\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"important-stdio-transport-compatibility",children:"Important: stdio Transport Compatibility"}),"\n",(0,i.jsxs)(n.p,{children:["When using stdio transport (the default for Claude Desktop), ",(0,i.jsx)(n.strong,{children:"all logging must go to stderr"}),". Writing to stdout corrupts the JSON-RPC message stream."]}),"\n",(0,i.jsxs)(n.p,{children:["MCPKit's ",(0,i.jsx)(n.code,{children:"@Debug"})," decorator automatically uses ",(0,i.jsx)(n.code,{children:"console.error"})," (stderr) for all log levels. If you provide a custom logger, ensure it writes to stderr:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// CORRECT - writes to stderr\nconst logger: DebugLogger = {\n  log(level, message, data) {\n    console.error(`[${level}] ${message}`, data);\n  },\n};\n\n// WRONG - writes to stdout, breaks stdio transport!\nconst badLogger: DebugLogger = {\n  log(level, message, data) {\n    console.log(`[${level}] ${message}`, data); // DON'T DO THIS\n  },\n};\n"})}),"\n",(0,i.jsx)(n.h2,{id:"combining-debug-and-monitor",children:"Combining @Debug and @Monitor"}),"\n",(0,i.jsx)(n.p,{children:"You can use both decorators together for different purposes:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"@Tool({ description: 'Complex operation' })\n@Debug({\n  enabled: process.env.NODE_ENV === 'development',\n  logArgs: true,\n  logResult: true,\n})\n@Monitor({\n  logDuration: true,\n  logErrors: true,\n})\nasync complexOperation(@Param({ name: 'input' }) input: string) {\n  // In development: Full debug output\n  // In production: Just timing and errors via Monitor\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Use @Debug for development"}),", disable in production for performance"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Use @Monitor for production"})," with minimal logging (duration, errors)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Always sanitize sensitive data"})," when logging arguments"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Custom loggers must use stderr"})," for stdio transport compatibility"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Use global config"})," to enable/disable debug across all methods"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Log levels should match severity"})," - don't log debug info at error level"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"see-also",children:"See Also"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/mcpkit/docs/guides/hooks",children:"Hooks Guide"})," - Server lifecycle hooks"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/mcpkit/docs/observability/overview",children:"Observability Guide"})," - Metrics, tracing, health checks"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/mcpkit/docs/guides/tracing-decorator",children:"@Traced Decorator"})," - Distributed tracing"]}),"\n"]})]})}function g(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453(e,n,r){r.d(n,{R:()=>s,x:()=>l});var o=r(6540);const i={},t=o.createContext(i);function s(e){const n=o.useContext(t);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),o.createElement(t.Provider,{value:n},e.children)}}}]);